<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>DLR Mission</title>
<!-- Bootstrap core CSS -->
<link rel="stylesheet"
  href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
  integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
  crossorigin="anonymous">

<!-- Custom styles for prosEO -->
<link href="../static/fragments/proseo.css" th:href="@{/fragments/proseo.css}" rel="stylesheet" type="text/css"/>
</head>

<body>
	<nav
		class="navbar bg-light sticky-top flex-md-nowrap p-0 shadow navbar-expand-md">
		<div class="container-fluid pl-0 pr-0">
      <a class="navbar-brand col-md-3 col-lg-2 mr-0 px-3" id="mission"
        href="/"><img src="proseo_logo.png" class="rounded" width="50"
        height="50"></a>
      <button class="navbar-toggler position-absolute d-md-none collapsed"
        type="button" data-toggle="collapse" data-target="#sidebarMenu"
        aria-controls="sidebarMenu" aria-expanded="false"
        aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
			<ul class="navbar-nav mr-auto navbar-left">
				<li class="p-breadcrumb-item"><a class="bread-link" href="/"><span
						th:text="${missioncode}">mission</span></a></li>
				<li class="p-breadcrumb-item" aria-current="page"><span
					th:text="#{order-show}">show</span></li>
			</ul>
      <div th:replace="fragments/navbar.html :: navbarRight"></div>
		</div>
	</nav>

	<div class="container-fluid">
    <div class="row">
      <div th:insert="fragments/sidebar.html :: sidebarMenu"></div>

      <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4">
			<div class="container-fluid">
				<form name="ord-shw" id="ord-shw" action="/order-show/get"
					method="get">

					<div class="input-group mb-3">
						<p class="text-left">
							<label for="orderid"><span th:text="#{order-id}"></span></label>
							<input type="text" class="form-control" id="orderid">
						</p>
					</div>
					<div class="input-group mb-3">
						<p class="text-left">
							<label for="fromDate"><span th:text="#{start-date}"></span></label>
						</p>
						<p class="text-left">
							<input type="date" class="form-control" id="fromDate">
						</p>
						<p class="text-left">
							<label for="toDate"><span th:text="#{end-date}"></span></label>
						</p>
						<p class="text-left">
							<input type="date" class="form-control" id="toDate">
						</p>
					</div>
					<div class="input-group mb-3">
						<button type="button" onclick="retrieveData();"
							class="btn btn-primary mb-2">
							<span th:text="#{order-show}"></span>
						</button>
					</div>
				</form>

			</div>
			<div class="container">
				<h2>
					<span th:text="#{order}"></span>
				</h2>

				<div id="content" name="content">
					<table class="table table-hover" id="orderTable">
						<thead class="thead-dark">
							<tr>
								<th><span th:text="#{order-id}"></span></th>
								<th><span th:text="#{processing-order}"></span></th>
								<th><span th:text="#{orderstate}"></span></th>
								<th><span th:text="#{orbit}"></span></th>
                <th><span th:text="#{product}"></span></th>
                <th><span>&nbsp;</span></th>
							</tr>
						</thead>
						<tbody th:unless="${orders} == null">
							<!-- 				  table-danger   - dark rose -->
							<!-- 				  table-info     - light blue -->
							<!-- 				  table-warning  - light sand -->
							<!-- 				  table-success  - light green -->
							<tr th:each="ord : ${orders}"
								th:class="(${ord?.orderState} == 'FAILED' or ${ord?.hasFailedJobSteps} == true)
					                ? 'table-danger' 
					                : ((${ord?.orderState} == 'RUNNING' or ${ord?.orderState} == 'SUSPENDING') 
					                    ? 'table-success' 
					                    : ((${ord?.orderState} == 'COMPLETED' or ${ord?.orderState} == 'CLOSED') 
					                        ? 'table-info' 
					                        : ((${ord?.orderState} == 'INITIAL' or ${ord?.orderState} == 'APPROVED' or ${ord?.orderState} == 'PLANNED' or ${ord?.orderState} == 'RELEASED') 
					                            ? 'table-warning' 
					                            : 'table-danger')))">
								<td><button type="button" class="collapsible"
										th:text="${ord?.id}"></button></td>
								<td th:text="${ord?.identifier}"></td>
								<td th:text="${ord?.state}"></td>
								<td th:text="${ord?.orbits}"></td>
                <td th:text="${ord?.requestedProductClasses}"></td>
								<td><div class="dropdown">
										<a class="nav-link " data-toggle="dropdown"
											aria-haspopup="true" aria-expanded="false" role="button"><img
											alt="Menu" src="more-vertical.svg"></span></a>
										<div class="dropdown-menu">
                      <a class="dropdown-item" href="#"><span th:text="#{approve}">approve</span></a>
                      <a class="dropdown-item" href="#"><span th:text="#{plan}">plan</span></a>
                      <a class="dropdown-item" href="#"><span th:text="#{release}">release</span></a>
                      <a class="dropdown-item" href="#"><span th:text="#{suspend}">suspend</span></a>
                      <a class="dropdown-item" href="#"><span th:text="#{suspendforce}">suspendforce</span></a>
                      <a class="dropdown-item" href="#"><span th:text="#{resume}">resume</span></a>
                      <a class="dropdown-item" href="#"><span th:text="#{reset}">reset</span></a>
                      <a class="dropdown-item" href="#"><span th:text="#{cancel}">cancel</span></a>
                      <a class="dropdown-item" href="#"><span th:text="#{close}">close</span></a>
                      <a class="dropdown-item" href="#"><span th:text="#{delete}">delete</span></a>
											<div class="dropdown-divider"></div>
											<a class="dropdown-item" href="#">Separated link</a>
										</div>
									</div></td>
							</tr>
						</tbody>
						<!--  <tr class = "table-danger">
  <tr class="table-info">
  <tr class="table-success"> -->

					</table>
				</div>
			</div>
			<div th:insert="fragments/footer.html :: footer"></div>
			</main>
		</div>
    </div>
	</div>
</body>
  <script src="https://unpkg.com/feather-icons"></script>
  <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.js"
    integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
    crossorigin="anonymous"></script>
  <script
    src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script
    src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
    crossorigin="anonymous"></script>
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
  <script src="../static/fragments/proseo.js" th:src="@{/fragments/proseo.js}" type="text/javascript"></script>

  <script type="text/javascript">
    function retrieveData() {
      var tableRows = $("orderTable").rows;
      if (tableRows > 1 && tableRows != null) {
        $("orderTable > tbody").empty();
      }
      var mission = document.getElementById('orderid').value;
      if (mission == null) {
        mission = "";
      }
      var url = "/order-show/get?identifier=" + mission;
      var prop = document.getElementById('test');

      $.ajax({
        url : url,
        method : "GET",
        success : function(res) {
          $("#content").html(res);
        },
        fail : function(err) {
          console.log(err);
          prop.innerHTML = "Fehler!" + err;
        }

      });
    };
  </script>
<script>
    window.onload = function () {
     // $('.collapse').collapse();
     var elem = document.getElementById('sb-order');
     $(elem).addClass('active');
     feather.replace();
     retrieveData();
     
    }
</script>

</html>